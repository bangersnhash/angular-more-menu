"use strict";function bnhMenuItem(e){return{restrict:"A",link:function(n,i,t){n.$on("bnh-responsive-nav:overflow",function(){if("desktop"===e.getMediaQuery()){var o=n.$eval(t.option);o.isOverflow=i.get(0).offsetTop>0?!0:!1,o.isOverflow===!0&&o.index>0&&(n.options.mainmenu.children[o.index-1].isOverflow=!0)}})}}}function moreMenuService(e,n,i){function t(e,n,i){var t=[];return e.forEach(function(e){(!i||_.matches(i)(e))&&t.push(_.assign(e,n))}),t}function o(e){if(e.children&&M&&(e.children=M(e.children)),e.children&&e.children.length){e.hasDropdown=!0,e.columns=0===e.level&&_.filter(e.children,"children").length===e.children.length&&e.children.length||1;for(var n=0,i=e.children.length;i>n;n++){var t=e.children[n];t.level=e.level+1,t.index=n,t.isOpen=!1,o(t)}}else e.hasDropdown=!1,e.columns=0}function r(e){e.isOpen=!0}function l(e){e.isOpen=!1}function u(e,n){n.isOpen=!n.isOpen,n.isOpen?S.push(n):_.remove(S,{isOpen:!1}),S.length?(r(e),0===n.level&&e.$broadcast("more-menu:open")):l(e)}function s(e){for(;S.length;)S.shift().isOpen=!1;l(e)}function c(){return w=i.innerWidth,b=i.innerHeight,$=w>=600?"desktop":"phone"}function a(e){M=e}function d(){return $}function h(){return w}function m(){return b}function p(){return i.pageYOffset}function f(){if("desktop"===moreMenuService.getMediaQuery()){var e=moreMenuService.getScrollOffset(),n=e>y?"down":"up";if(y=e,100>=e)return!1;if(e>100&&"down"===n)return!0}return null}function g(e,i){angular.isFunction(i)&&(i={post:i});var t,o=e.contents().remove();return{pre:i&&i.pre?i.pre:null,post:function(e,r){t||(t=n(o)),t(e,function(e){r.append(e)}),i&&i.post&&i.post.apply(null,arguments)}}}function v(e,n,i){var t;i.fn?(_.isFunction(e[i.fn])?e[i.fn]():e.functions&&_.isFunction(e.functions[i.fn])&&e.functions[i.fn](),s(e)):i.isOverflow&&i.hasDropdown?u(e,i):i.root||"desktop"===$&&0===i.level&&i.hasDropdown?(t=i.isOpen,s(e),i.style="phone"===$?{"max-height":b-100+"px"}:{},t||u(e,i)):i.hasDropdown?u(e,i):s(e)}var w,b,$,M,S=[],y=0,O={setProperty:t,setDefaultProperties:o,setMenuFilter:a,updateMediaQuery:c,getMediaQuery:d,getWindowWidth:h,getWindowHeight:m,getScrollOffset:p,getCollapsed:f,recursiveCompile:g,handleClick:v,closeAll:s,menuOn:r,menuOff:l};return O}var angular=require("angular");angular.module("bnh.more.menu",[]),require("./scripts/nav"),require("./scripts/nav-item"),require("./scripts/service"),require("./scripts/sub"),$templateCache.put("nav.html",'\n\n<nav class="bnh-nav" ng-class="{\'is-open\': options.mainmenu.isOpen, \'is-hidden\': options.mainmenu.isHidden}" ng-style="options.mainmenu.style">\n  <ul ng-show="showMainmenu" class="bnh-menu-items" role="menu">\n    <li class="bnh-menu-item phone-only all-products is-hidden">\n      <a href="#" ng-click="showProductSelect()">\n        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" width="16px" height="16px" viewBox="0 0 408 408" style="enable-background:new 0 0 408 408;" xml:space="preserve"><g><g id="apps"><path d="M0,102h102V0H0V102z M153,408h102V306H153V408z M0,408h102V306H0V408z M0,255h102V153H0V255z M153,255h102V153H153V255z     M306,0v102h102V0H306z M153,102h102V0H153V102z M306,255h102V153H306V255z M306,408h102V306H306V408z"/></g></g></svg>\n        All Products\n      </a>\n    </li>\n\n    <li bnh-menu-item class="bnh-menu-item" role="menuitem" ng-repeat="child in options.mainmenu.children" option="child" ng-class="{\'is-active\': isCurrentState(child), \'is-open\': child.isOpen, \'is-hidden\': child.isHidden }">\n      <a ng-click="handleClick($event, child)" ng-href="{{getOptionHref(child)}}" ng-class="{\'has-dropdown\': child.children}">\n        {{child.title}}\n      </a>\n      <bnh-sub options="child"></bnh-sub>\n    </li>\n\n    <li class="bnh-menu-item" role="menuitem" option="options.moremenu" ng-class="{\'is-open\': options.moremenu.isOpen, \'is-hidden\': options.moremenu.isHidden}">\n      <a class="has-dropdown" ng-click="handleClick($event, options.moremenu)">\n        {{options.moremenu.title}}\n      </a>\n      <bnh-sub ng-if="options.moremenu.isOpen" options="options.moremenu"></bnh-sub>\n    </li>\n  </ul>\n</nav>\n'),angular.module("bnh.more.menu").directive("bnhMenuItem",["moreMenuService",bnhMenuItem]),$templateCache.put("sub.html",'<div class="bnh-sub" role="menu" ng-if="child.isOpen && child.children && child.children.length" ng-style="subStyle">\n  <div class="bnh-sub-content">\n    <ul ng-if="!child.columns || child.columns <= 1">\n      <li class="bnh-sub-item" role="menuitem" ng-repeat="child in child.children" ag-feature="{{child[\'feature-toggle\']}}">\n        <a ng-click="handleClick($event, child)" ng-href="{{getOptionHref(child)}}" ng-if="!child.hasDropdown">\n          {{child.title}}\n        </a>\n        <div ng-if="child.hasDropdown">\n          <span class="has-dropdown" ng-click="handleClick($event, child)" ng-class="{\'is-open\': child.isOpen}">{{child.title}}</span>\n          <bnh-sub ng-if="child.isOpen" options="child"></bnh-sub>\n        </div>\n      </li>\n    </ul>\n    <ul ng-if="child.columns > 1" ng-repeat="column in child.children">\n      <li class="bnh-sub-head">{{column.title}}</li>\n      <li class="bnh-sub-item" role="menuitem" ng-repeat="child in column.children" ag-feature="{{child[\'feature-toggle\']}}">\n        <a ng-click="handleClick($event, child)" ng-href="{{getOptionHref(child)}}" ng-if="!child.hasDropdown">\n          {{child.title}}\n        </a>\n        <span ng-if="child.hasDropdown">{{child.title}}</span>\n        <bnh-sub ng-if="child.hasDropdown && child.isOpen" options="child"></bnh-sub>\n      </li>\n    </ul>\n  </div>\n</div>\n'),angular.module("bnh.more.menu").directive("bnhMoreMenu",["$compile","$document","$http","$filter","$injector","$interpolate","$interval","$q","$timeout","$window","moreMenuService",function(e,n,i,t,o,r,l,u,s,c,a){return{restrict:"E",scope:{data:"=?",dataSource:"=?",menuFilter:"=?"},templateUrl:"angular-more-menu/views/nav.html",link:function(e,n){function t(e){return!e.isHidden}function r(e){return e.isOverflow?!0:!1}function l(n){return n.sref&&e.hasUiRouter?g.href(n.sref):n.uri?n.uri:""}function d(n,i){s(function(){(i||0===e.$element.has(n.target).length)&&a.closeAll(e)})}function h(){if(e.collapse){var n=a.getCollapsed();null!==n&&(e.isCollapsed=n)}}function m(n,i){i&&(e.options[n].all=i),e.options[n].children=angular.copy(e.options[n].all)||[],a.setDefaultProperties(e.options[n]),e.redrawMenuItems()}function p(n){var t=u.defer();return v[n]?i.get(v[n]).then(function(i){i&&i.data?m(n,i.data):e.options[n].children=[],t.resolve()}):w[n]&&(m(n,w[n]),t.resolve()),t}function f(){a.closeAll(e),a.updateMediaQuery(),e.options.mainmenu.isHidden=!1,a.setProperty(e.options.mainmenu.children,{isHidden:!1}),e.options.moremenu.isHidden=!0,e.options.moremenu.hasDropdown=!1,e.options.moremenu.children.splice(0,e.options.moremenu.children.length),"phone"===a.getMediaQuery()?e.options.mainmenu.isOpen=!1:s(function(){e.$apply(function(){e.$broadcast("bnh-responsive-nav:overflow");var n=angular.copy(a.setProperty(e.options.mainmenu.children,{isHidden:!0},{isOverflow:!0}));n&&n.length&&(a.setProperty(n,{level:1}),e.options.moremenu.children.push.apply(e.options.moremenu.children,n),e.options.moremenu.hasDropdown=!0,e.options.moremenu.isHidden=!1)})})}e.$element=$(n),e.dataSource||(e.dataSource="data/mainmenu.json"),e.menuFilter&&a.setMenuFilter(e.menuFilter),e.hasUiRouter=o.has("ui.router");var g=e.hasUiRouter?o.get("ui.router"):null,v={mainmenu:e.dataSource},w={mainmenu:e.data};e.options={mainmenu:{title:"Menu",isHidden:!0,level:-1,children:[],root:!0},moremenu:{title:"More",isHidden:!0,level:0,children:[]}},e.redrawMenuItems=f,e.checkScrollState=h,e.documentClick=d;var b=_.throttle(function(){e.$apply(e.redrawMenuItems)},100),M=_.throttle(function(){e.$apply(e.checkScrollState)},200);angular.element(c).on("resize",b),angular.element(c).on("scroll",M),a.updateMediaQuery(),p("mainmenu").then(function(){e.redrawMenuItems()}),m("mainmenu"),e.mainFilter=t,e.moreFilter=r,e.getOptionHref=l,e.$watch("breadcrumb",e.redrawMenuItems,!0),e.$watch("dataSource",function(){e.dataSource&&e.dataSource!==v.mainmenu&&(v.mainmenu=e.dataSource,p("mainmenu"))}),e.$watch("usermenuSource",function(){e.usermenuSource&&e.usermenuSource!==v.usermenu&&(v.usermenu=e.usermenuSource,p("usermenu"))}),e.$watch("pageTitleContent",function(n){var i=e.$element.find("#title-content");angular.isFunction(n)?(i.append(n()),e.showPageTitleContent=!0):(i.empty(),e.showPageTitleContent=!1)}),e.$watch("replacementPageTitleContent",function(n){var i=e.$element.find("#title-content"),t=angular.isFunction(n)?n():n;angular.isDefined(t)?(i.html(t),e.showPageTitleContent=!0):(i.empty(),e.showPageTitleContent=!1)})},controller:["$scope","$state","$location","moreMenuService",function(e,n,i,t){e.handleClick=function(n,i){t.handleClick(e,n,i)},e.isCurrentState=function(e){var t;return e.sref?n.includes(e.sref):e.uri?(t=e.uri.substring(e.uri.indexOf("#")+1),0===i.path().indexOf(t)):void 0}}]}}]),angular.module("bnh.more.menu").factory("moreMenuService",["$filter","$compile","$window",moreMenuService]),module.exports=function(){angular.module("bnh.more.menu").directive("bnhSub",["$timeout","moreMenuService",function(e,n){return{restrict:"E",scope:{child:"=options"},templateUrl:"angular-more-menu/views/sub.html",compile:function(i){return n.recursiveCompile(i,function(i,t){i.subStyle={};var o=function(){i.child.isOpen&&"desktop"===n.getMediaQuery()&&(e(function(){if(!i.child.root){var e=t.parent().offset().left,o=t.children().width();e+o>n.getWindowWidth()?i.subStyle.left="-"+(e+o-n.getWindowWidth()+30)+"px":delete i.subStyle.left}i.subStyle.maxHeight=n.getWindowHeight()-100+"px"},0),i.subStyle.opacity=1)};i.subStyle={},i.child&&0===i.child.level&&(i.$on("ag-chrome:open",function(){o()}),o()),i.handleClick=function(e,t){n.handleClick(i,e,t),i.$emit("ag-chrome:open")}})}}}])};